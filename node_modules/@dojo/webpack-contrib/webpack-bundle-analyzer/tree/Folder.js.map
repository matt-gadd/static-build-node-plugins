{"version":3,"file":"Folder.js","sourceRoot":"","sources":["Folder.ts"],"names":[],"mappings":";;AAAA,4BAA4B;AAC5B,sCAAsC;AAEtC,qCAA8B;AAC9B,6CAAsC;AACtC,6DAAsD;AACtD,mCAA6C;AAE7C,YAA4B,SAAQ,oBAAU;IAG7C,IAAI,UAAU;QACb,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,SAAS,CAAC;IAC/C,CAAC;IAED,IAAI,QAAQ;QACX,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC,CAAC,CAAC;YAC/B,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC;QACjE,CAAC;QAED,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC;IACvB,CAAC;IAED,SAAS,CAAC,UAAe;QACxB,MAAM,SAAS,GAAG,0BAAkB,CAAC,UAAU,CAAC,CAAC;QAEjD,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC;YAChB,MAAM,CAAC;QACR,CAAC;QAED,MAAM,CAAC,OAAO,EAAE,QAAQ,CAAC,GAAG,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;QACxE,IAAI,aAAa,GAAG,IAAI,CAAC;QAEzB,CAAC,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,UAAU,EAAE,EAAE;YAC9B,IAAI,SAAS,GAAG,aAAa,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC;YAEnD,EAAE,CAAC,CAAC;YACH,4BAA4B;YAC5B,CAAC,SAAS;gBACV,0GAA0G;gBAC1G,kEAAkE;gBAClE,0DAA0D;gBAC1D,oEAAoE;gBACpE,CAAC,CAAC,SAAS,YAAY,MAAM,CAC9B,CAAC,CAAC,CAAC;gBACF,SAAS,GAAG,aAAa,CAAC,cAAc,CAAC,IAAI,MAAM,CAAC,UAAU,CAAC,CAAC,CAAC;YAClE,CAAC;YAED,aAAa,GAAG,SAAS,CAAC;QAC3B,CAAC,CAAC,CAAC;QAEH,MAAM,iBAAiB,GAAG,UAAU,CAAC,OAAO,CAAC,CAAC,CAAC,4BAAkB,CAAC,CAAC,CAAC,gBAAM,CAAC;QAC3E,MAAM,MAAM,GAAG,IAAI,iBAAiB,CAAC,QAAQ,EAAE,UAAU,EAAE,IAAI,CAAC,CAAC;QACjE,aAAa,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC;IACtC,CAAC;IAED,WAAW;QACV,MAAM,mBACF,KAAK,CAAC,WAAW,EAAE,IACtB,UAAU,EAAE,IAAI,CAAC,UAAU,EAC3B,QAAQ,EAAE,IAAI,CAAC,QAAQ,IACtB;IACH,CAAC;CACD;AAvDD,yBAuDC","sourcesContent":["import * as _ from 'lodash';\nimport * as gzipSize from 'gzip-size';\n\nimport Module from './Module';\nimport BaseFolder from './BaseFolder';\nimport ConcatenatedModule from './ConcatenatedModule';\nimport { getModulePathParts } from './utils';\n\nexport default class Folder extends BaseFolder {\n\tprivate _gzipSize: any;\n\n\tget parsedSize() {\n\t\treturn this.src ? this.src.length : undefined;\n\t}\n\n\tget gzipSize() {\n\t\tif (!_.has(this, '_gzipSize')) {\n\t\t\tthis._gzipSize = this.src ? gzipSize.sync(this.src) : undefined;\n\t\t}\n\n\t\treturn this._gzipSize;\n\t}\n\n\taddModule(moduleData: any) {\n\t\tconst pathParts = getModulePathParts(moduleData);\n\n\t\tif (!pathParts) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst [folders, fileName] = [pathParts.slice(0, -1), _.last(pathParts)];\n\t\tlet currentFolder = this;\n\n\t\t_.each(folders, (folderName) => {\n\t\t\tlet childNode = currentFolder.getChild(folderName);\n\n\t\t\tif (\n\t\t\t\t// Folder is not created yet\n\t\t\t\t!childNode ||\n\t\t\t\t// In some situations (invalid usage of dynamic `require()`) webpack generates a module with empty require\n\t\t\t\t// context, but it's moduleId points to a directory in filesystem.\n\t\t\t\t// In this case we replace this `File` node with `Folder`.\n\t\t\t\t// See `test/stats/with-invalid-dynamic-require.json` as an example.\n\t\t\t\t!(childNode instanceof Folder)\n\t\t\t) {\n\t\t\t\tchildNode = currentFolder.addChildFolder(new Folder(folderName));\n\t\t\t}\n\n\t\t\tcurrentFolder = childNode;\n\t\t});\n\n\t\tconst ModuleConstructor = moduleData.modules ? ConcatenatedModule : Module;\n\t\tconst module = new ModuleConstructor(fileName, moduleData, this);\n\t\tcurrentFolder.addChildModule(module);\n\t}\n\n\ttoChartData() {\n\t\treturn {\n\t\t\t...super.toChartData(),\n\t\t\tparsedSize: this.parsedSize,\n\t\t\tgzipSize: this.gzipSize\n\t\t};\n\t}\n}\n"]}