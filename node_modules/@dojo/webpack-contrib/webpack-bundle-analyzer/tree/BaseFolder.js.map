{"version":3,"file":"BaseFolder.js","sourceRoot":"","sources":["BaseFolder.ts"],"names":[],"mappings":"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","sourcesContent":["import * as _ from 'lodash';\nimport BaseNode from './Node';\n\nexport default class BaseFolder extends BaseNode {\n\tprivate children: any = Object.create(null);\n\tprivate _src: any;\n\tprivate _size: any;\n\n\tconstructor(name: string, parent?: BaseNode) {\n\t\tsuper(name, parent);\n\t}\n\n\tget src() {\n\t\tif (!this._src) {\n\t\t\tthis._src = this.walk(\n\t\t\t\t(node: any, src: any, stop: any) => {\n\t\t\t\t\tif (node.src === undefined) {\n\t\t\t\t\t\treturn stop(undefined);\n\t\t\t\t\t}\n\t\t\t\t\treturn (src += node.src);\n\t\t\t\t},\n\t\t\t\t'',\n\t\t\t\tfalse\n\t\t\t);\n\t\t}\n\n\t\treturn this._src;\n\t}\n\n\tget size() {\n\t\tif (!_.has(this, '_size')) {\n\t\t\tthis._size = this.walk((node: any, size: any) => size + node.size, 0, false);\n\t\t}\n\n\t\treturn this._size;\n\t}\n\n\tgetChild(name: any) {\n\t\treturn this.children[name];\n\t}\n\n\taddChildModule(module: any) {\n\t\tconst { name } = module;\n\t\tconst currentChild = this.children[name];\n\n\t\t// For some reason we already have this node in children and it's a folder.\n\t\tif (currentChild && currentChild instanceof BaseFolder) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (currentChild) {\n\t\t\t// We already have this node in children and it's a module.\n\t\t\t// Merging it's data.\n\t\t\tcurrentChild.mergeData(module.data);\n\t\t} else {\n\t\t\t// Pushing new module\n\t\t\tmodule.parent = this;\n\t\t\tthis.children[name] = module;\n\t\t}\n\n\t\tdelete this._size;\n\t\tdelete this._src;\n\t}\n\n\taddChildFolder(folder: any) {\n\t\tfolder.parent = this;\n\t\tthis.children[folder.name] = folder;\n\t\tdelete this._size;\n\t\tdelete this._src;\n\n\t\treturn folder;\n\t}\n\n\twalk(walker: any, state = {}, deep = true) {\n\t\tlet stopped = false;\n\n\t\t_.each(this.children, (child) => {\n\t\t\tif (deep && child.walk) {\n\t\t\t\tstate = child.walk(walker, state, stop);\n\t\t\t} else {\n\t\t\t\tstate = walker(child, state, stop);\n\t\t\t}\n\n\t\t\tif (stopped) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\n\t\treturn state;\n\n\t\tfunction stop(finalState: any) {\n\t\t\tstopped = true;\n\t\t\treturn finalState;\n\t\t}\n\t}\n\n\ttoChartData() {\n\t\treturn {\n\t\t\tlabel: this.name,\n\t\t\tpath: this.path,\n\t\t\tstatSize: this.size,\n\t\t\tgroups: _.invokeMap(this.children, 'toChartData')\n\t\t};\n\t}\n}\n"]}